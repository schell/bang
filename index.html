<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>.:!:.</title>
        <style type="text/css" media="screen">
            body {
        			margin:0px;
        			background: url(http://slaughterballoon.com/SlaughterBalloon-iso.png) fixed bottom left no-repeat;
        			font-family: Verdana,Geneva,Arial,sans-serif;
        			font-size: 12px;
        			line-height: 15px;
                    text-align:center;
        		}
            canvas {
                background-color:transparent;
            }
        </style>
        <script src="mod.js" type="text/javascript" charset="utf-8"></script>
        <script src="http://schell.github.com/go/go.js" type="text/javascript" charset="utf-8"></script>
        <link rel="shortcut icon" href="favicon.png" />
    </head>
    <body id="body">
        
        <div id="bang"></div>
        
        <script type="text/javascript" charset="utf-8">
            mod.useTagInjection = true;
            mod.expansions = {
                bang : 'src/',
                meshes : 'meshes/'
            };
            mod({
                name : "Main",
                dependencies : [
                    'bang::View/Stage3d.js',
                    'bang::View/View3d.js',
                    'bang::Geometry/Transform3d.js',
                    'bang::Utils/Ease.js',
                    'meshes::TrashCan.js'
                ],
                init : function initMain (Stage3d, View3d, Transform3d, Ease, TrashCan) {
                    var stage = new Stage3d(300, 300);
                    stage.useShader(stage.shaders.texShader);
                    stage.y = -2;
                    stage.z = -8;
                    stage.rotationX = -Math.PI/3;
                    document.body.appendChild(stage.canvas);
                    var spin = new Ease({
                        target : stage,
                        duration : 5000,
                        properties : {
                            rotationZ : 2*Math.PI
                        },
                        onComplete : function (spin) {
                            stage.rotationZ = 0;
                            spin.interpolate();
                        }
                    }).interpolate();

                    var view = new View3d();
                    view.scaleX = 2;
                    view.scaleY = 2;
                    view.useShader(stage.shaders.colorShader);
                    var top = 3;
                    var trans = new Ease ({
                        target : view,
                        duration : 5000,
                        properties : {
                            z : top
                        },
                        onComplete : function (trans) {
                            // Cycle up and down...
                            trans.config.properties.z = view.z == top ? 0 : top;
                            trans.interpolate();
                        }
                    }).interpolate();
                    stage.addView(view);
                    
                    // Add the trashcan mesh...
                    stage.mesh = new TrashCan();
                    // Create an image for the texture...
                    var texture = new Image();
                    texture.onload = function() {
                        // Create a texture on the shader...
                        stage.shaders.texShader.createTexture('trashcan', texture);
                        stage.initialize();
                    };
                    texture.src = stage.mesh.dataURL;
                    return {};
                }
            });
        </script>
    </body>
</html>