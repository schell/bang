<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>bang::compiler</title>
        <script type="text/javascript" charset="utf-8" src="http://schell.github.com/mod/mod.js"></script>
    </head>
    <body id="compiler">
        <script type="text/javascript" charset="utf-8">
            mod.useTagInjection = true;
            mod.expansions = {
                bang : 'src/'
            };
            
            mod({
                name : 'Compiler',
                dependencies : [ 'bang::Utils/PNGEncoder.js' ],
                init : function initCompiler (m) {
                    /**
                     * Initializes the Compiler 
                     * @param - m Object - The mod modules object.
                     */
                    var header = document.createElement('h2');
                    header.innerHTML = 'Enter your code into and click outside the textarea to compile...';
                    var output = document.createElement('div');
                    var png = false;
                    var textArea = document.createElement('textarea');
                    textArea.cols = 45;
                    textArea.rows = 10;
                    textArea.onchange = function() {
                        var src = textArea.value;
                        if (png) {
                            output.removeChild(png);
                        }
                        png = m.PNGEncoder.PNGFromString(src);
                        output.appendChild(png);
                    };
                    document.body.appendChild(header);
                    document.body.appendChild(textArea);
                    document.body.appendChild(output);
                    
                    return {};
                }
            });
        </script>
    </body>
</html>